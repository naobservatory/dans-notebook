{
  "hash": "6549c565bcbe30d9fc314c680b0f4f2d",
  "result": {
    "markdown": "---\ntitle: NAO Cost Estimate MVP\nauthor: Dan Rice\ndate: '2024-02-02'\nformat:\n  html:\n    code-fold: false\n    toc: true\n---\n\n## Background\n\nSee [Google Doc](https://docs.google.com/document/d/1YAy4Dnvk7H5J7jOt7iCeBYqE6z3TdgHSr3jetimlJHo/edit)\nfor background.\nSee also [Simple detection cost model](https://docs.google.com/document/d/1aHboNUDrXWAmTmZGg9Ne8dyTUdEpsluafB48DJp1UN4/edit#heading=h.vijzo0j6vjkg) for P2RA version.\n\n## Epidemic model\n\n### Prevalence and incidence\n\nConsider a population of $N$ individuals.\nWe focus on the phase of the epidemic when it is growing exponentially.\nThis will be approximately true at an intermediate time when the virus is common enough\nthat we can neglect noise in reproduction, but rare enough that it is not running out of\nsusceptible people to infect.\nLet the rate of new infections per interaction per unit time to be $\\alpha$ and the rate of recovery of an infected person to be $\\beta$.\nThen, we have the following ODE for the prevalence $P(t)$:\n\n$$\n\\frac{dP}{dt} \\approx \\alpha N P - \\beta P.\n$$\n\nThe first term on the right-hand side is the incidence per unit time: $I \\approx \\alpha N P$.\n(Note that we are assuming that the number of susceptible people is approximately $N$, which will\ncease to be true as the virus becomes common.)\n\nSolving this equation and choosing $t = 0$ to be the time when one person is infected gives:\n$$\n\\begin{align}\nP(t) & = e^{(\\alpha N - \\beta) t} \\\\\n     & = e^{rt} \\\\\nI(t) & = \\alpha N e^{rt} \\\\\n     & = (r + \\beta) e^{rt},\n\\end{align}\n$$\nwhere we have defined the exponential growth rate $r \\equiv \\alpha N - \\beta$.\n\n### Cumulative incidence\n\nAs a yardstick for measuring the progress of the epidemic, we are interested in the *cumulative* incidence, $C(t)$, the number of people who have ever been infected.\nIntegrating $I(t)$ with the initial condition $C(0) = 1$ to account for the single individual infected at $t = 0$, we have:\n$$\n\\begin{align}\nC(t) & = 1 + \\int_0^t I(t') dt' \\\\\n     & = 1 + \\frac{r + \\beta}{r} (e^{rt} - 1).\n\\end{align}\n$$\nNote that when sick individuals never recover ($\\beta = 0$), $C(t) = P(t)$, as expected.\n\nA useful feature of the exponential growth regime is that all of our quantities of interest grow exponentially at the same rate and are thus in proportion to one another:\n$$\n\\begin{align}\nI(t) & = (r + \\beta) P(t) \\\\\nC(t) & \\sim \\frac{r + \\beta}{r} P(t), \\text{as } t \\to \\infty.\n\\end{align}\n$$\n\nRearranging, we see that the fraction of cumulative incidence that are currently infected is controled by the ratio of growth rate to recovery rate:\n$$\n\\frac{P(t)}{C(t)} \\sim \\frac{r}{r + \\beta}.\n$$\nThis ranges from zero when the epidemic grows slowly and individuals recover quickly, to one wher the epidemic grows much faster than recovery.\nFor a virus like SARS-CoV-2, where both doubling and recovery times were on the order of a week, we expect on the order of half of the cumulative infections to be currently sick during the exponetial phase.\n\n### Domain of validity\n\nAs described above, the approximation of deterministic exponential growth is valid when the number of infected individuals is large enough that the growth is roughly deteriminstic but small enough that most of the population is still susceptible.\nHere we'll approximate those bounds.\n\n#### Deterministic growth\n\nA simple stochastic model of the start of an epidemic is that infections and recoveries in a small increment of time $dt$ are independent of one another, that is:\n$$\n\\begin{align}\n\\text{\\# Births} & \\sim \\text{Poisson}(\\alpha N P dt) \\\\\n\\text{\\# Deaths} & \\sim \\text{Poisson}(\\beta P dt).\n\\end{align}\n$$\nThis implies that the change in prevalence, $dP = (\\text{\\# Births}) - (\\text{\\# Deaths})$, during $[t, t+dt)$ has mean and variance:\n$$\n\\begin{align}\n\\mathbb{E}(dP) & = (\\alpha N - \\beta) P dt \\\\\n               & = r P dt \\\\\n\\mathbb{V}(dP) & = (\\alpha N + \\beta) P dt \\\\\n               & = (r + 2 \\beta) P dt.\n\\end{align}\n$$\n\nA deterministic approximation is good when the coefficient of variation of $dP$ is much smaller than one, that is:\n$$\n\\begin{align}\n\\frac{\\sqrt{\\mathbb{V}(dP)}}{\\mathbb{E}(dP)} & \\ll 1 \\\\\n\\frac{\\sqrt{(r + 2 \\beta) P dt}}{r P dt} & \\ll 1 \\\\.\n\\end{align}\n$$\nSome algebra gives the condition that the prevalence is larger than a critical value:\n$$\nP \\gg \\frac{r + 2 \\beta}{r^2 dt}.\n$$\nIt remains to choose a suitable increment of time.\nWe expect the prevalence to change significantly ($\\mathbb{E}(\\frac{dP}{P}) = 1$) on the timescale $r^{-1}$ so $dt = r^{-1}$ is a reasonable choice as long as $r \\gtrsim \\beta$.\nThis gives the condition\n$$\nP \\gg \\frac{r + 2 \\beta}{r} = 1 + 2 \\beta / r.\n$$\nWhen this condition is met, we expect the epidemic to grow approximately deterministically at rate $r$.\n\nNote that this condition is violated at $t = 0$.\nWe must thus reinterpret $t = 0$ as the *effective* time that the epidemic would have infected a single person if our derterministic approximation for $P \\gg 1 + 2\\beta/r$ were extended backwards in time.\n[TODO: estimate the error in cumulative infections introduced by making this approximation.]\n\n#### Exponential growth\n\nAs the virus spreads, the number of susceptible people declines, reducing the rate of spread and resulting in sub-exponential growth.\nLet the number of susceptible people be $S(t)$, then the incidence per time is:\n$$\nI(t) = \\alpha S(t) P(t).\n$$\nAbove, we assumed that $S(t) = N$.\n$I(t)$ will thus be reduced by half by the time $S(t) = N / 2$.\nThis is a convenient upper bound on the domain of validity.\n\nAssuming that anyone previously infected is no longer susceptible, we have:\n$$\n\\begin{align}\nS(t) & \\gg N / 2 \\\\\nN - C(t) & \\gg N / 2 \\\\\nC(t) & \\ll N / 2.\n\\end{align}\n$$\n\nUsing $C = \\frac{r + \\beta}{r} P$ in the exponential regime, we can put this together with our lower bound of the deterministic approximation to get the region of validity:\n$$\n1 + 2\\beta / r \\ll P \\ll \\frac{N}{2 (1 + \\beta / r)}.\n$$\nThis shows that as long as the population is large ($N \\gg 1$), and the growth rate is not too slow compared to the recovery rate ($r \\gtrsim \\beta$), there will be a wide regime of approximately deterministic exponential growth.\n\n## Counts and detection\n\n- Sample at times $\\{t_0, t_1, \\ldots\\}$.\n- Sequence $n_i$ reads in sample taken at $t_i$.\n- Deterministic relative abundance: $a_i = b p(t_i)$, where $b$ is a fixed conversion factor between prevalence and relative abundance.\n- Deterministic viral read counts: $k_i = n_i a_i$\n- Cumulative count: $K_i = \\sum_{j=0}^i k_j$\n- Detection when cumulative counts exceed a threshold $K_i > \\hat{K}$\n\n### Continuous sampling\n\n- Connection to P2RA report calculation.\n- What to do about $t_0$\n\n### Grab sampling\n\n",
    "supporting": [
      "2024-02-02_CostEstimateMVP_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}