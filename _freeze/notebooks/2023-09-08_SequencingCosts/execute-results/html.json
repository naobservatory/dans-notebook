{
  "hash": "e28de342b903f874e8ff27a8c26eedea",
  "result": {
    "markdown": "---\ntitle: Airport experiment sequencing cost estimate\nauthor: Dan Rice\ndate: '2023-09-08'\nformat:\n  html:\n    code-fold: false\n---\n\nWe are planning to sequence samples from four sources (redacted because this is publicly visible).\nWe will receive one sample from each source each day weekday for eight weeks.\nThus we will have $8 \\times 5 \\times 4 = 160$ samples total.\n\nWe will the following steps ourselves:\n\n- Concentrate the samples\n- Filter out large particles (to enrich for viruses)\n- Extract RNA\n\nThen we will deliver the RNA extracts to the BioMicroCenter for:\n\n- RNA seq library prep:\n\n  - Standard RNA prep (not high-throughput), pricing and QC are per sample\n  - Total RNA sequencing, includes sample QC, ribosomal depletion, generation of cDNA, library construction, indexing and library quality control\n\n- Sequencing on an Illumina NovaSeq 6000 S4 with 300nt per read pair.\n\n\nThe goal of this doc is to estimate the cost of library prep and sequencing.\n\n## Sources\n\n- The cost of [library prep](https://openwetware.org/wiki/BioMicroCenter:Pricing#SHORT_READ_LIBRARY_-_RNA) and [sequencing](https://openwetware.org/wiki/BioMicroCenter:Pricing#NOVASEQ_SEQUENCING) come from the BioMicroCenter's pricing page. We use the MIT prices.\n- Characteristics of the NovaSeq come from [illumina](https://www.illumina.com/content/dam/illumina/gcs/assembled-assets/marketing-literature/novaseq-6000-spec-sheet-m-gl-00271/novaseq-6000-spec-sheet-m-gl-00271.pdf) (Table 1).\n\n## Estimate\n\nEach NovaSeq flow cell has 4 lanes.\nWhen run in `2 x 150 bp` mode, it generates 150 basepair forward and reverse read pairs for 300 bp per read pair.\nIn one run, the flow cell generates 2400--3000 Gb of data.\nIn the following we will make a conservative estimate by using the lower end of the range.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nlanes_per_flow_cell = 4\nbp_per_read_pair = 300\ngb_per_flow_cell = 2400\n\nread_pairs_per_flow_cell = gb_per_flow_cell * 1e9 / bp_per_read_pair\nread_pairs_per_lane = read_pairs_per_flow_cell / lanes_per_flow_cell\nprint(f\"We expect at least {read_pairs_per_lane/1e6} M read pairs per lane\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWe expect at least 2000.0 M read pairs per lane\n```\n:::\n:::\n\n\nThe smallest unit of NovaSeq sequencing we can buy is one lane,\nwhich costs $5,940.\nWe also pay $258.5 per sample for library preparation.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ncost_per_lane = 5940\nlibrary_cost_per_sample = 258.5\n```\n:::\n\n\nWe'll consider three options:\n\n1. Sequencing all 160 samples in 4 lanes\n1. Sequencing all 160 samples in 8 lanes\n2. Sequencing MWF only ($160 \\times 3/5 = 96$ samples) in 5 lanes\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nfor num_samples, num_lanes in [(160, 4), (160, 8), (96, 5)]:\n    samples_per_lane = num_samples / num_lanes\n    read_pairs_per_sample = read_pairs_per_lane / samples_per_lane\n    sequencing_cost = cost_per_lane * num_lanes\n    library_cost = library_cost_per_sample * num_samples\n    total_cost = sequencing_cost + library_cost\n    cost_per_sample = total_cost / num_samples\n    cost_per_read_pair = cost_per_sample / read_pairs_per_sample\n    print(f\"\"\"\n    {num_samples} samples in {num_lanes} lanes:\n        Million read pairs per sample:\\t{read_pairs_per_sample / 1e6:3,.0f}\n        Sequencing cost:\\t${sequencing_cost:7,.0f}\n        Library prep cost:\\t${library_cost:7,.0f}\n        Total cost:\\t\\t\\t${total_cost:7,.0f}\n        Cost per sample:\\t${cost_per_sample:7,.0f}\n        Cost per M rp:\\t\\t${cost_per_read_pair * 1e6:10.2f}\n    \"\"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n    160 samples in 4 lanes:\n        Million read pairs per sample:\t 50\n        Sequencing cost:\t$ 23,760\n        Library prep cost:\t$ 41,360\n        Total cost:\t\t\t$ 65,120\n        Cost per sample:\t$    407\n        Cost per M rp:\t\t$      8.14\n    \n\n    160 samples in 8 lanes:\n        Million read pairs per sample:\t100\n        Sequencing cost:\t$ 47,520\n        Library prep cost:\t$ 41,360\n        Total cost:\t\t\t$ 88,880\n        Cost per sample:\t$    556\n        Cost per M rp:\t\t$      5.56\n    \n\n    96 samples in 5 lanes:\n        Million read pairs per sample:\t104\n        Sequencing cost:\t$ 29,700\n        Library prep cost:\t$ 24,816\n        Total cost:\t\t\t$ 54,516\n        Cost per sample:\t$    568\n        Cost per M rp:\t\t$      5.45\n    \n```\n:::\n:::\n\n\n",
    "supporting": [
      "2023-09-08_SequencingCosts_files"
    ],
    "filters": [],
    "includes": {}
  }
}
