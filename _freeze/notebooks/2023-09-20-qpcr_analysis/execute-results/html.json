{
  "hash": "e6119591912aa5f518077c9d4fdb80e4",
  "result": {
    "markdown": "---\ntitle: \"2023-07-18 Extraction Experiment 1 qPCR Analysis\"\nauthor: \"Dan Rice\"\ndate: 2023-09-20\ntoc: true\nformat:\n  html:\n    code-fold: false\n---\n\n## Objectives\n\nTesting the efficacy of RNA extraction kits in influent samples.\nSee [experiment google doc](https://docs.google.com/document/d/1KOAolQzHvCE8dHVn9bxrBJwm7sLAHeJQQjzc_lslBf0/edit?usp=sharing).\n\n## Preliminary work\n\n- Someone else already exported qPCR results as CSV\n- I copied the file `meta_samples.csv` and manually added elution volumes\n  that I found in [this doc](https://docs.google.com/document/d/1AJfbucGj1frkfl2jfVNSlLgP2pjnAYZwiYy91Oy_wzg/edit#bookmark=id.atrajjxwxf20)\n  and saved the results in `meta_samples_with_elution_volumes.csv`.\n\n## Data import\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(purrr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(broom)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_dir <-\n  \"~/airport/[2023-07-18] Extraction-kit comparison 1: Influent/qPCR results/\"\nfilename_pattern <- \"_Results_\"\n```\n:::\n\n\nNot sure why I had to change `skip` from 23 to 22.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncol_types <- list(\n  Target = col_character(),\n  Cq = col_double()\n)\nraw_data <- list.files(\n  data_dir,\n  pattern = filename_pattern,\n  recursive = TRUE,\n  full.names = TRUE,\n) |>\n  print() |>\n  map(function(f) {\n    read_csv(f,\n      skip = 22,\n      col_types = col_types,\n    )\n  }) |>\n  list_rbind()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"/Users/dan/airport/[2023-07-18] Extraction-kit comparison 1: Influent/qPCR results//Cov2/2023-07-26_Cov2-kits_Results_20230728 133121.csv\"        \n[2] \"/Users/dan/airport/[2023-07-18] Extraction-kit comparison 1: Influent/qPCR results//CrA/2023-07-26_CrA-kits_Results_20230728 135806.csv\"          \n[3] \"/Users/dan/airport/[2023-07-18] Extraction-kit comparison 1: Influent/qPCR results//Noro/2023-07-26_Noro_kits_Results_20230728 140336.csv\"        \n[4] \"/Users/dan/airport/[2023-07-18] Extraction-kit comparison 1: Influent/qPCR results//phagemid/2023-07-26_Phagemid-kits_Results_20230728 141050.csv\"\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\nOne or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\nOne or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\nOne or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\n```\n:::\n\n```{.r .cell-code}\nprint(raw_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 333 × 21\n    Well `Well Position` Omit  Sample  Target Task    Reporter Quencher\n   <dbl> <chr>           <lgl> <chr>   <chr>  <chr>   <chr>    <chr>   \n 1     1 A1              FALSE 1_ZR_A  Cov2   UNKNOWN FAM      NFQ-MGB \n 2     2 A2              FALSE 1_ZR_B  Cov2   UNKNOWN FAM      NFQ-MGB \n 3     3 A3              FALSE 1_ZR_C  Cov2   UNKNOWN FAM      NFQ-MGB \n 4     4 A4              FALSE 2_ZDR_A Cov2   UNKNOWN FAM      NFQ-MGB \n 5     5 A5              FALSE 2_ZDR_B Cov2   UNKNOWN FAM      NFQ-MGB \n 6     6 A6              FALSE 2_ZDR_C Cov2   UNKNOWN FAM      NFQ-MGB \n 7     7 A7              FALSE 3_IP_A  Cov2   UNKNOWN FAM      NFQ-MGB \n 8     8 A8              FALSE 3_IP_B  Cov2   UNKNOWN FAM      NFQ-MGB \n 9     9 A9              FALSE 3_IP_C  Cov2   UNKNOWN FAM      NFQ-MGB \n10    10 A10             FALSE 4_NV_A  Cov2   UNKNOWN FAM      NFQ-MGB \n# ℹ 323 more rows\n# ℹ 13 more variables: `Amp Status` <chr>, `Amp Score` <dbl>,\n#   `Curve Quality` <lgl>, `Result Quality Issues` <lgl>, Cq <dbl>,\n#   `Cq Confidence` <dbl>, `Cq Mean` <dbl>, `Cq SD` <dbl>,\n#   `Auto Threshold` <lgl>, Threshold <dbl>, `Auto Baseline` <lgl>,\n#   `Baseline Start` <dbl>, `Baseline End` <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nraw_data |> count(Target)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 2\n  Target     n\n  <chr>  <int>\n1 Cov2      71\n2 CrA       95\n3 Noro      71\n4 Phg       96\n```\n:::\n:::\n\n\nTODO: use other metadata table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata_file <- paste0(data_dir, \"meta_samples_with_elution_volumes.csv\")\nmetadata <- read_csv(metadata_file)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 27 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (7): sample_qPCR, Kit, treatment_group, LPA, other_treatment, Virus_spec...\ndbl (2): group, Elution_volume\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nglimpse(metadata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 27\nColumns: 9\n$ sample_qPCR     <chr> \"1_ZR_A\", \"1_ZR_B\", \"1_ZR_C\", \"2_ZDR_A\", \"2_ZDR_B\", \"2…\n$ Kit             <chr> \"Zymo RNA\", \"Zymo RNA\", \"Zymo RNA\", \"Zymo RNA/DNA\", \"Z…\n$ treatment_group <chr> \"ZQ-RNA\", \"ZQ-RNA\", \"ZQ-RNA\", \"ZQ-RNADNA\", \"ZQ-RNADNA\"…\n$ LPA             <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", …\n$ group           <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ other_treatment <chr> \"Shield\", \"Shield\", \"Shield\", \"Shield\", \"Shield\", \"Shi…\n$ Virus_specific  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"No\", \"No\", …\n$ FP_Data         <chr> \"No\", \"Yes\", \"No\", \"No\", \"Yes\", \"No\", \"No\", \"Yes\", \"No…\n$ Elution_volume  <dbl> 15, 15, 15, 50, 50, 50, 100, 100, 100, 30, 30, 30, 100…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_data <- raw_data |>\n  mutate(\n    replicate = str_extract(Sample, \"[A-Z]$\"),\n  ) |>\n  left_join(\n    metadata,\n    by = join_by(Sample == sample_qPCR)\n  )\nglimpse(tidy_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 333\nColumns: 30\n$ Well                    <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,…\n$ `Well Position`         <chr> \"A1\", \"A2\", \"A3\", \"A4\", \"A5\", \"A6\", \"A7\", \"A8\"…\n$ Omit                    <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS…\n$ Sample                  <chr> \"1_ZR_A\", \"1_ZR_B\", \"1_ZR_C\", \"2_ZDR_A\", \"2_ZD…\n$ Target                  <chr> \"Cov2\", \"Cov2\", \"Cov2\", \"Cov2\", \"Cov2\", \"Cov2\"…\n$ Task                    <chr> \"UNKNOWN\", \"UNKNOWN\", \"UNKNOWN\", \"UNKNOWN\", \"U…\n$ Reporter                <chr> \"FAM\", \"FAM\", \"FAM\", \"FAM\", \"FAM\", \"FAM\", \"FAM…\n$ Quencher                <chr> \"NFQ-MGB\", \"NFQ-MGB\", \"NFQ-MGB\", \"NFQ-MGB\", \"N…\n$ `Amp Status`            <chr> \"Amp\", \"Amp\", \"Amp\", \"Amp\", \"Amp\", \"Amp\", \"Amp…\n$ `Amp Score`             <dbl> 1.1919015, 1.2241620, 1.3026766, 1.3064751, 1.…\n$ `Curve Quality`         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ `Result Quality Issues` <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ Cq                      <dbl> 33.59224, 33.85453, 32.88852, 32.32325, 35.019…\n$ `Cq Confidence`         <dbl> 0.9630252, 0.9623811, 0.9919308, 0.9907208, 0.…\n$ `Cq Mean`               <dbl> 33.98352, 33.89186, 33.66943, 33.92028, 34.152…\n$ `Cq SD`                 <dbl> 0.55335254, 0.05279505, 1.10437933, 2.25853860…\n$ `Auto Threshold`        <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE…\n$ Threshold               <dbl> 0.04098764, 0.04098764, 0.04098764, 0.04098764…\n$ `Auto Baseline`         <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE…\n$ `Baseline Start`        <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…\n$ `Baseline End`          <dbl> 31, 30, 30, 29, 32, 31, 31, 31, 30, 32, 33, 31…\n$ replicate               <chr> \"A\", \"B\", \"C\", \"A\", \"B\", \"C\", \"A\", \"B\", \"C\", \"…\n$ Kit                     <chr> \"Zymo RNA\", \"Zymo RNA\", \"Zymo RNA\", \"Zymo RNA/…\n$ treatment_group         <chr> \"ZQ-RNA\", \"ZQ-RNA\", \"ZQ-RNA\", \"ZQ-RNADNA\", \"ZQ…\n$ LPA                     <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\"…\n$ group                   <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 3, 3, 3, 3…\n$ other_treatment         <chr> \"Shield\", \"Shield\", \"Shield\", \"Shield\", \"Shiel…\n$ Virus_specific          <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"No\"…\n$ FP_Data                 <chr> \"No\", \"Yes\", \"No\", \"No\", \"Yes\", \"No\", \"No\", \"Y…\n$ Elution_volume          <dbl> 15, 15, 15, 50, 50, 50, 100, 100, 100, 30, 30,…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_data |>\n  count(Sample, Kit, LPA, Target, replicate) |>\n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 126 × 6\n    Sample      Kit                 LPA   Target replicate     n\n    <chr>       <chr>               <chr> <chr>  <chr>     <int>\n  1 1.0         <NA>                <NA>  Cov2   <NA>          3\n  2 1.0         <NA>                <NA>  Noro   <NA>          3\n  3 10.0        <NA>                <NA>  Cov2   <NA>          3\n  4 10.0        <NA>                <NA>  Noro   <NA>          3\n  5 100.0       <NA>                <NA>  Cov2   <NA>          3\n  6 100.0       <NA>                <NA>  Noro   <NA>          3\n  7 1000.0      <NA>                <NA>  Cov2   <NA>          3\n  8 1000.0      <NA>                <NA>  Noro   <NA>          3\n  9 10000.0     <NA>                <NA>  Cov2   <NA>          2\n 10 10000.0     <NA>                <NA>  Noro   <NA>          2\n 11 1_ZR_A      Zymo RNA            No    Cov2   A             2\n 12 1_ZR_A      Zymo RNA            No    CrA    A             3\n 13 1_ZR_A      Zymo RNA            No    Noro   A             2\n 14 1_ZR_A      Zymo RNA            No    Phg    A             3\n 15 1_ZR_B      Zymo RNA            No    Cov2   B             2\n 16 1_ZR_B      Zymo RNA            No    CrA    B             3\n 17 1_ZR_B      Zymo RNA            No    Noro   B             2\n 18 1_ZR_B      Zymo RNA            No    Phg    B             3\n 19 1_ZR_C      Zymo RNA            No    Cov2   C             2\n 20 1_ZR_c      <NA>                <NA>  CrA    <NA>          3\n 21 1_ZR_c      <NA>                <NA>  Noro   <NA>          2\n 22 1_ZR_c      <NA>                <NA>  Phg    <NA>          3\n 23 20          <NA>                <NA>  CrA    <NA>          3\n 24 200         <NA>                <NA>  CrA    <NA>          3\n 25 2000        <NA>                <NA>  CrA    <NA>          3\n 26 20000       <NA>                <NA>  CrA    <NA>          3\n 27 2_ZDR_A     Zymo RNA/DNA        No    Cov2   A             2\n 28 2_ZDR_A     Zymo RNA/DNA        No    CrA    A             3\n 29 2_ZDR_A     Zymo RNA/DNA        No    Noro   A             2\n 30 2_ZDR_A     Zymo RNA/DNA        No    Phg    A             3\n 31 2_ZDR_B     Zymo RNA/DNA        No    Cov2   B             2\n 32 2_ZDR_B     Zymo RNA/DNA        No    CrA    B             2\n 33 2_ZDR_B     Zymo RNA/DNA        No    Noro   B             2\n 34 2_ZDR_B     Zymo RNA/DNA        No    Phg    B             3\n 35 2_ZDR_C     Zymo RNA/DNA        No    Cov2   C             2\n 36 2_ZDR_C     Zymo RNA/DNA        No    CrA    C             3\n 37 2_ZDR_C     Zymo RNA/DNA        No    Noro   C             2\n 38 2_ZDR_C     Zymo RNA/DNA        No    Phg    C             3\n 39 3_IP_A      Invitrogen Purelink No    Cov2   A             2\n 40 3_IP_A      Invitrogen Purelink No    CrA    A             3\n 41 3_IP_A      Invitrogen Purelink No    Noro   A             2\n 42 3_IP_A      Invitrogen Purelink No    Phg    A             3\n 43 3_IP_B      Invitrogen Purelink No    Cov2   B             2\n 44 3_IP_B      Invitrogen Purelink No    CrA    B             3\n 45 3_IP_B      Invitrogen Purelink No    Noro   B             2\n 46 3_IP_B      Invitrogen Purelink No    Phg    B             3\n 47 3_IP_C      Invitrogen Purelink No    Cov2   C             2\n 48 3_IP_C      Invitrogen Purelink No    CrA    C             3\n 49 3_IP_C      Invitrogen Purelink No    Noro   C             2\n 50 3_IP_C      Invitrogen Purelink No    Phg    C             3\n 51 4_NV_A      Nucleospin Virus    No    Cov2   A             2\n 52 4_NV_A      Nucleospin Virus    No    CrA    A             3\n 53 4_NV_A      Nucleospin Virus    No    Noro   A             2\n 54 4_NV_A      Nucleospin Virus    No    Phg    A             3\n 55 4_NV_B      Nucleospin Virus    No    Cov2   B             2\n 56 4_NV_B      Nucleospin Virus    No    CrA    B             3\n 57 4_NV_B      Nucleospin Virus    No    Noro   B             2\n 58 4_NV_B      Nucleospin Virus    No    Phg    B             3\n 59 4_NV_C      Nucleospin Virus    No    Cov2   C             2\n 60 4_NV_C      Nucleospin Virus    No    CrA    C             3\n 61 4_NV_C      Nucleospin Virus    No    Noro   C             2\n 62 4_NV_C      Nucleospin Virus    No    Phg    C             3\n 63 5_QM_A      QIAamp MinElute     No    Cov2   A             2\n 64 5_QM_A      QIAamp MinElute     No    CrA    A             3\n 65 5_QM_A      QIAamp MinElute     No    Noro   A             2\n 66 5_QM_A      QIAamp MinElute     No    Phg    A             3\n 67 5_QM_B      QIAamp MinElute     No    Cov2   B             2\n 68 5_QM_B      QIAamp MinElute     No    CrA    B             3\n 69 5_QM_B      QIAamp MinElute     No    Noro   B             2\n 70 5_QM_B      QIAamp MinElute     No    Phg    B             3\n 71 5_QM_C      QIAamp MinElute     No    Cov2   C             2\n 72 5_QM_C      QIAamp MinElute     No    CrA    C             3\n 73 5_QM_C      QIAamp MinElute     No    Noro   C             2\n 74 5_QM_C      QIAamp MinElute     No    Phg    C             3\n 75 6_QVR_A     QIAamp Viral RNA    No    Cov2   A             2\n 76 6_QVR_A     QIAamp Viral RNA    No    CrA    A             3\n 77 6_QVR_A     QIAamp Viral RNA    No    Noro   A             2\n 78 6_QVR_A     QIAamp Viral RNA    No    Phg    A             3\n 79 6_QVR_B     QIAamp Viral RNA    No    Cov2   B             2\n 80 6_QVR_B     QIAamp Viral RNA    No    CrA    B             3\n 81 6_QVR_B     QIAamp Viral RNA    No    Noro   B             2\n 82 6_QVR_B     QIAamp Viral RNA    No    Phg    B             3\n 83 6_QVR_C     QIAamp Viral RNA    No    Cov2   C             2\n 84 6_QVR_C     QIAamp Viral RNA    No    CrA    C             3\n 85 6_QVR_C     QIAamp Viral RNA    No    Noro   C             2\n 86 6_QVR_C     QIAamp Viral RNA    No    Phg    C             3\n 87 7_NV-car_A  Nucleospin Virus    Yes   Cov2   A             2\n 88 7_NV-car_A  Nucleospin Virus    Yes   CrA    A             3\n 89 7_NV-car_A  Nucleospin Virus    Yes   Noro   A             2\n 90 7_NV-car_A  Nucleospin Virus    Yes   Phg    A             3\n 91 7_NV-car_B  Nucleospin Virus    Yes   Cov2   B             2\n 92 7_NV-car_B  Nucleospin Virus    Yes   CrA    B             3\n 93 7_NV-car_B  Nucleospin Virus    Yes   Noro   B             2\n 94 7_NV-car_B  Nucleospin Virus    Yes   Phg    B             3\n 95 7_NV-car_C  Nucleospin Virus    Yes   Cov2   C             2\n 96 7_NV-car_C  Nucleospin Virus    Yes   CrA    C             3\n 97 7_NV-car_C  Nucleospin Virus    Yes   Noro   C             2\n 98 7_NV-car_C  Nucleospin Virus    Yes   Phg    C             3\n 99 8_QM-car_A  QIAamp MinElute     Yes   Cov2   A             2\n100 8_QM-car_A  QIAamp MinElute     Yes   CrA    A             3\n101 8_QM-car_A  QIAamp MinElute     Yes   Noro   A             2\n102 8_QM-car_A  QIAamp MinElute     Yes   Phg    A             3\n103 8_QM-car_B  QIAamp MinElute     Yes   Cov2   B             2\n104 8_QM-car_B  QIAamp MinElute     Yes   CrA    B             3\n105 8_QM-car_B  QIAamp MinElute     Yes   Noro   B             2\n106 8_QM-car_B  QIAamp MinElute     Yes   Phg    B             3\n107 8_QM-car_C  QIAamp MinElute     Yes   Cov2   C             2\n108 8_QM-car_C  QIAamp MinElute     Yes   CrA    C             3\n109 8_QM-car_C  QIAamp MinElute     Yes   Noro   C             2\n110 8_QM-car_C  QIAamp MinElute     Yes   Phg    C             3\n111 9_QVR-car_A QIAamp Viral RNA    Yes   Cov2   A             2\n112 9_QVR-car_A QIAamp Viral RNA    Yes   CrA    A             3\n113 9_QVR-car_A QIAamp Viral RNA    Yes   Noro   A             2\n114 9_QVR-car_A QIAamp Viral RNA    Yes   Phg    A             3\n115 9_QVR-car_B QIAamp Viral RNA    Yes   Cov2   B             2\n116 9_QVR-car_B QIAamp Viral RNA    Yes   CrA    B             3\n117 9_QVR-car_B QIAamp Viral RNA    Yes   Noro   B             2\n118 9_QVR-car_B QIAamp Viral RNA    Yes   Phg    B             3\n119 9_QVR-car_C QIAamp Viral RNA    Yes   Cov2   C             2\n120 9_QVR-car_C QIAamp Viral RNA    Yes   CrA    C             3\n121 9_QVR-car_C QIAamp Viral RNA    Yes   Noro   C             2\n122 9_QVR-car_C QIAamp Viral RNA    Yes   Phg    C             3\n123 <NA>        <NA>                <NA>  Cov2   <NA>          3\n124 <NA>        <NA>                <NA>  CrA    <NA>          3\n125 <NA>        <NA>                <NA>  Noro   <NA>          3\n126 <NA>        <NA>                <NA>  Phg    <NA>         15\n```\n:::\n:::\n\n\n## Kit comparison\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_data |>\n  filter(!is.na(Kit)) |>\n  ggplot(mapping = aes(\n    x = Cq,\n    y = Kit,\n    color = interaction(replicate, LPA),\n  )) +\n  stat_summary(\n    fun.min = min,\n    fun.max = max,\n    fun = median,\n    position = position_dodge(width = 0.2),\n    size = 0.2\n  ) +\n  facet_wrap(facets = ~Target, scales = \"free_x\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 15 rows containing non-finite values (`stat_summary()`).\n```\n:::\n\n::: {.cell-output-display}\n![](2023-09-20-qpcr_analysis_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Adjusting for elution volume\n\nAssume the amplification efficiency is 100%, so that\nan increase in initial concentration by a factor of $x$\ndecreases $C_q$ by $\\log_{2}(x)$.\n\nIf a method has elution volume $v$ and we dilute it to total volume $V$,\nthis reduces its final concentration by a factor $v / V$.\nWe can put different\nmethods on the same footing by adding $\\log_{2}(v/V)$ to $C_q$\n(so that large elution volumes are penalized with a higher adjusted $C_q$).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_volume <- 100\ntidy_data |>\n  mutate(elution_adjusted_Cq = Cq + log2(Elution_volume / final_volume)) |>\n  filter(!is.na(Kit)) |>\n  ggplot(mapping = aes(\n    x = elution_adjusted_Cq,\n    y = Kit,\n    color = interaction(replicate, LPA),\n  )) +\n  stat_summary(\n    fun.min = min,\n    fun.max = max,\n    fun = median,\n    position = position_dodge(width = 0.2),\n    size = 0.2\n  ) +\n  facet_wrap(facets = ~Target, scales = \"free_x\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 15 rows containing non-finite values (`stat_summary()`).\n```\n:::\n\n::: {.cell-output-display}\n![](2023-09-20-qpcr_analysis_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "2023-09-20-qpcr_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
